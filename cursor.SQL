---------------------------CREACION DE LA TABLA--------------
CREATE TABLE XX_TABLA_PRAC
(
  ID_EMPLEADO       NUMBER,
  NOMBRE            VARCHAR2(100 BYTE),
  APELLIDO          VARCHAR2(100 BYTE),
  CREATION_DATE     DATE,
  CREATED_BY        NUMBER,
  LAST_UPDATE_DATE  DATE,
  LAST_UPDATED_BY   NUMBER
);

---------------------------CREACI�N DE LA SECUENCIA---------------
CREATE SEQUENCE XX_SECUENCIA_PRAC
  START WITH 1
  MAXVALUE 9999
  MINVALUE 1
  CYCLE
  NOCACHE
  NOORDER;
  
  ---------------------INICIALIZAR LA SECUENCIA---------------
  SELECT XX_SECUENCIA_PRAC.NEXTVAL FROM XX_TABLA_PRAC;
  
----------------------------INSERSI�N DE REGISTROS--------------------
DECLARE
    O_ID NUMBER (2):=XX_SECUENCIA_PRAC.NEXTVAL;
    O_NAME XX_TABLA_PRAC.NOMBRE%TYPE := 'ISAMAR';
    O_APE XX_TABLA_PRAC.APELLIDO%TYPE := 'GONZALEZ';
    O_DATE DATE:=SYSDATE;
    O_BY NUMBER(2):=XX_SECUENCIA_PRAC.NEXTVAL;
    O_LUD DATE:=SYSDATE;
    O_LUB NUMBER(2):=XX_SECUENCIA_PRAC.NEXTVAL;

BEGIN 
    INSERT INTO  XX_TABLA_PRAC(
        ID_EMPLEADO, NOMBRE, APELLIDO, CREATION_DATE, CREATED_BY, LAST_UPDATE_DATE, LAST_UPDATED_BY  
    )
    VALUES(
        O_ID, O_NAME , O_APE , O_DATE, O_BY, O_LUD, O_LUB
    );
    EXCEPTION
      WHEN OTHERS THEN
        DBMS_OUTPUT.PUT_LINE('ERROR: '||sqlcode||' _ '||sqlerrm);  
END;

-------------------------------VISTA DE LOS REGISTROS DE LA TABLA--------
SELECT * FROM XX_TABLA_PRAC;
----------------------------------- ELIMINCI�N DE REGISTRO----------------
DECLARE 
    ID_E XX_TABLA_PRAC.id_empleado%TYPE := 1;
BEGIN
    DELETE FROM XX_TABLA_PRAC
WHERE 
    ID_EMPLEADO = ID_E;
END;
-------------------------------ACTUALIZACI�N DE REGISTROS------------
DECLARE 
    NOM XX_TABLA_PRAC.NOMBRE%TYPE := 'FERNANDO';
BEGIN
    UPDATE XX_TABLA_PRAC
SET ID_EMPLEADO = XX_SECUENCIA_PRAC.NEXTVAL, 
    CREATION_DATE = SYSDATE, 
    CREATED_BY = XX_SECUENCIA_PRAC.NEXTVAL, 
    LAST_UPDATE_DATE = SYSDATE, 
    last_updated_by = XX_SECUENCIA_PRAC.NEXTVAL
WHERE 
    NOMBRE = NOM;
END;


---------------------USO DE CURSORES-------
DECLARE 
    CURSOR CURSOR_UNO
            (ID_EM NUMBER) IS
    SELECT ID_EMPLEADO, NOMBRE, APELLIDO
    FROM XX_TABLA_PRAC
    WHERE ID_EMPLEADO = ID_EM;
BEGIN
    OPEN CURSOR_UNO (10);
    CLOSE CURSOR_UNO;
EXCEPTION
  WHEN NO_DATA_FOUND THEN
    DBMS_OUTPUT.PUT_LINE('ERROR'||sqlcode||' '||sqlerrm);
    
END;

-------------------------------ACTUALIZACI�N DE REGISTRO CON MERGE---------
DECLARE 
    V_NULL  XX_TABLA_PRAC.ID_EMPLEADO%TYPE := NULL;
    ID NUMBER(2) := 11;
BEGIN
    MERGE
        INTO XX_TABLA_PRAC XX
        USING XX_TABLA_PRAC E
        ON (XX.ID_EMPLEADO = NULL)
    WHERE MATCHED THEN
        UPDATE SET
            XX.ID_EMPLEADO = ID,
            XX.CREATION_DATE = SYSDATE,
            XX.CREATED_BY = ID,
            XX.LAST_UPDATE_DATE = SYSDATE,
            XX.LAST_UPDATED_BY = ID;
END;

